{
"title": "Suffix Array (Doubling Algorithm)",
"subtitle": "Construct suffix array in O(n log n) for string processing",
"time_complexity": "O(n log n)",
"space_complexity": "O(n)",
"category": "String Algorithms",
"code": [
    "def suffix_array(s):",
    "    s += '\\0'",
    "    n = len(s)",
    "    sa = list(range(n))",
    "    rank = [ord(c) for c in s]",
    "    k = 1",
    "    while k < n:",
    "        sa.sort(key=lambda i: (rank[i], rank[i+k] if i+k < n else -1))",
    "        tmp = [0] * n",
    "        for i in range(1, n):",
    "            prev, curr = sa[i-1], sa[i]",
    "            tmp[curr] = tmp[prev] + ( (rank[prev], rank[prev+k] if prev+k<n else -1) != (rank[curr], rank[curr+k] if curr+k<n else -1) )",
    "        rank = tmp[:]",
    "        k <<= 1",
    "    return sa[1:]" 
],
"additional_information": "Doubling method sorts suffixes by 2^k-length prefixes iteratively. Remove the added sentinel when returning results if desired."
}
