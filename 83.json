{
"title": "Mo’s Algorithm (Query on Array)",
"subtitle": "Offline algorithm to answer range queries efficiently",
"time_complexity": "O((N + Q) * sqrt(N))",
"space_complexity": "O(N + Q)",
"category": "Offline Queries / Square Root Decomposition",
"code": [
    "import math",
    "def mos_algorithm(arr, queries):",
    "    n = len(arr)",
    "    block_size = int(math.sqrt(n))",
    "    queries.sort(key=lambda x: (x[0] // block_size, x[1]))",
    "    curr_l, curr_r, answer = 0, 0, 0",
    "    res = [0]*len(queries)",
    "    # Example: sum query",
    "    freq = [0]*100001  # adjust according to value range",
    "    def add(x):",
    "        nonlocal answer",
    "        answer += x",
    "    def remove(x):",
    "        nonlocal answer",
    "        answer -= x",
    "    for idx, (l, r) in enumerate(queries):",
    "        while curr_r <= r:",
    "            add(arr[curr_r])",
    "            curr_r += 1",
    "        while curr_r > r + 1:",
    "            curr_r -= 1",
    "            remove(arr[curr_r])",
    "        while curr_l < l:",
    "            remove(arr[curr_l])",
    "            curr_l += 1",
    "        while curr_l > l:",
    "            curr_l -= 1",
    "            add(arr[curr_l])",
    "        res[idx] = answer",
    "    return res"
],
"additional_information": "Mo’s Algorithm reorders queries to minimize modifications between consecutive queries. Useful for offline range queries like sum, frequency, or xor."
}
